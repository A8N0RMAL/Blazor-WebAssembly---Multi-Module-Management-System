@page "/editproduct/{id:int}"
@inject ProductService ProductService
@inject CategoryService CategoryService
@inject NavigationManager NavigationManager

<PageTitle>Edit Product</PageTitle>

@if (product == null)
{
    <p>Loading product...</p>
}
else
{
    <div>
        <h2>Edit Product</h2>

        <form @onsubmit="HandleSubmit">
            <div>
                <label for="name">Name:</label>
                <input id="name" @bind="product.Name" />
            </div>

            <div>
                <label for="description">Description:</label>
                <textarea id="description" @bind="product.Description"></textarea>
            </div>

            <div>
                <label for="price">Price:</label>
                <input id="price" type="number" step="0.01" @bind="product.Price" />
            </div>

            <div>
                <button type="submit">Save Changes</button>
                <button type="button" @onclick="Cancel">Cancel</button>
            </div>

        </form>
    </div>
}

@code {
    [Parameter]
    public int Id { get; set; }

    private Product? product;

    protected override void OnParametersSet()
    {
        product = ProductService.GetProductById(Id);
    }

    private async Task HandleSubmit()
    {
        if (product != null)
        {
            ProductService.UpdateProduct(product);
            NavigationManager.NavigateTo($"/products/{Id}");
        }
    }

    private void Cancel()
    {
        NavigationManager.NavigateTo($"/products/{Id}");
    }
}